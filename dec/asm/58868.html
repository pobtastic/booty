<!DOCTYPE html>
<html>
<head>
<title>Booty: Routine at 58868</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-wide.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="58753.html">58753</a>
</td>
<td class="up">Up: <a href="../maps/all.html#58868">Map</a></td>
<td class="next">
Next: <a href="59068.html">59068</a>
</td>
</tr>
</table>
<div class="description">58868: Handler: Items</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="57000.html">InitialiseGame</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Handler_Items</td>
<td class="address-2"><span id="58868"></span>58868</td>
<td class="instruction">LD IX,(23520)</td>
<td class="comment-1" rowspan="1"><span class="register">IX</span>=<a href="23520.html">ReferenceItems</a>.</td>
</tr>
<tr>
<td class="asm-label">Handler_Items_Loop</td>
<td class="address-2"><span id="58872"></span>58872</td>
<td class="instruction">LD A,(IX+0)</td>
<td class="comment-1" rowspan="3">Return if *<span class="register">IX</span>+0 is equal to 255.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58875"></span>58875</td>
<td class="instruction">CP 255</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58877"></span>58877</td>
<td class="instruction">RET Z</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58878"></span>58878</td>
<td class="instruction">LD C,A</td>
<td class="comment-1" rowspan="1"><span class="register">C</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58879"></span>58879</td>
<td class="instruction">LD B,(IX+1)</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=*<span class="register">IX</span>+1.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58882"></span>58882</td>
<td class="instruction">LD A,(IX+5)</td>
<td class="comment-1" rowspan="3">Jump to <a href="58868.html#58906">Handler_Items_Next</a> if *<span class="register">IX</span>+5 is equal to 0.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58885"></span>58885</td>
<td class="instruction">CP 0</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58887"></span>58887</td>
<td class="instruction">JR Z,<a href="58868.html#58906">Handler_Items_Next</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58889"></span>58889</td>
<td class="instruction">LD A,(62002)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=*<a href="62001.html#62002">62002</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58892"></span>58892</td>
<td class="instruction">DEC A</td>
<td class="comment-1" rowspan="1">Decrease <span class="register">A</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58893"></span>58893</td>
<td class="instruction">CP B</td>
<td class="comment-1" rowspan="2">Jump to <a href="58868.html#58906">Handler_Items_Next</a> if <span class="register">A</span> is not equal to <span class="register">B</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58894"></span>58894</td>
<td class="instruction">JR NZ,<a href="58868.html#58906">Handler_Items_Next</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58896"></span>58896</td>
<td class="instruction">LD A,(62001)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=*<a href="62001.html">TablePlayerAttributes</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58899"></span>58899</td>
<td class="instruction">SUB C</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>-=<span class="register">C</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58900"></span>58900</td>
<td class="instruction">JR Z,<a href="58868.html#58913">Handler_Items_0</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="58868.html#58913">Handler_Items_0</a> if <span class="register">A</span> is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58902"></span>58902</td>
<td class="instruction">CP 255</td>
<td class="comment-1" rowspan="2">Jump to <a href="58868.html#58913">Handler_Items_0</a> if <span class="register">A</span> is equal to 255.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58904"></span>58904</td>
<td class="instruction">JR Z,<a href="58868.html#58913">Handler_Items_0</a></td>
</tr>
<tr>
<td class="asm-label">Handler_Items_Next</td>
<td class="address-2"><span id="58906"></span>58906</td>
<td class="instruction">LD DE,7</td>
<td class="comment-1" rowspan="2"><span class="register">IX</span>+=0007.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58909"></span>58909</td>
<td class="instruction">ADD IX,DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58911"></span>58911</td>
<td class="instruction">JR <a href="58868.html#58872">Handler_Items_Loop</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="58868.html#58872">Handler_Items_Loop</a>.</td>
</tr>
<tr>
<td class="asm-label">Handler_Items_0</td>
<td class="address-2"><span id="58913"></span>58913</td>
<td class="instruction">CALL <a href="58209.html#58306">58306</a></td>
<td class="comment-1" rowspan="1">Call <a href="58209.html#58306">58306</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58916"></span>58916</td>
<td class="instruction">LD A,4</td>
<td class="comment-1" rowspan="2">Write 4 to *<a href="65534.html">SoundFlag_General</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58918"></span>58918</td>
<td class="instruction">LD (65534),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58921"></span>58921</td>
<td class="instruction">LD A,0</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=0.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58923"></span>58923</td>
<td class="instruction">LD D,2</td>
<td class="comment-1" rowspan="2"><span class="register">DE</span>=Set the sprite width/ height (2/ 2).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58925"></span>58925</td>
<td class="instruction">LD E,2</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58927"></span>58927</td>
<td class="instruction">PUSH DE</td>
<td class="comment-1" rowspan="1">Stash <span class="register">DE</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58928"></span>58928</td>
<td class="instruction">CALL <a href="59183.html">59183</a></td>
<td class="comment-1" rowspan="1">Call <a href="59183.html">59183</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58931"></span>58931</td>
<td class="instruction">CALL 3545</td>
<td class="comment-1" rowspan="1">Call <a rel="noopener nofollow" href="https://skoolkid.github.io/rom/asm/0DD9.html">CL_SET</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58934"></span>58934</td>
<td class="instruction">POP DE</td>
<td class="comment-1" rowspan="1">Restore <span class="register">DE</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58935"></span>58935</td>
<td class="instruction">LD HL,40812</td>
<td class="comment-1" rowspan="2">Write <a href="41068.html">40812</a> (<a href="41068.html">Graphics_MaskSprite</a>) to *<a rel="noopener nofollow" href="https://skoolkit.ca/disassemblies/rom/hex/asm/5C36.html">CHARS</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58938"></span>58938</td>
<td class="instruction">LD (23606),HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58941"></span>58941</td>
<td class="instruction">LD A,32</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=32.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58943"></span>58943</td>
<td class="instruction">CALL <a href="60051.html">PrintSprite</a></td>
<td class="comment-1" rowspan="1">Call <a href="60051.html">PrintSprite</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58946"></span>58946</td>
<td class="instruction">LD (IX+5),0</td>
<td class="comment-1" rowspan="1">Write 5 to *<span class="register">IX</span>+5.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58950"></span>58950</td>
<td class="instruction">LD A,16</td>
<td class="comment-1" rowspan="4">Set INK: YELLOW (6).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58952"></span>58952</td>
<td class="instruction">RST 16</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58953"></span>58953</td>
<td class="instruction">LD A,6</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58955"></span>58955</td>
<td class="instruction">RST 16</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58956"></span>58956</td>
<td class="instruction">LD A,17</td>
<td class="comment-1" rowspan="4">Set PAPER: *<a href="23504.html">Active_BorderColour</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58958"></span>58958</td>
<td class="instruction">RST 16</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58959"></span>58959</td>
<td class="instruction">LD A,(23504)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58962"></span>58962</td>
<td class="instruction">RST 16</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="58963"></span>
<div class="comments">
<div class="paragraph">
Restore the default ZX Spectrum font.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58963"></span>58963</td>
<td class="instruction">LD HL,15360</td>
<td class="comment-1" rowspan="2">Write <a rel="noopener nofollow" href="https://skoolkit.ca/disassemblies/rom/hex/asm/3D00.html">15360</a> (CHARSET-256) to *<a rel="noopener nofollow" href="https://skoolkit.ca/disassemblies/rom/hex/asm/5C36.html">CHARS</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58966"></span>58966</td>
<td class="instruction">LD (23606),HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58969"></span>58969</td>
<td class="instruction">LD C,19</td>
<td class="comment-1" rowspan="3">Set up the screen buffer location 19/1 using <a rel="noopener nofollow" href="https://skoolkid.github.io/rom/asm/0DD9.html">CL_SET</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58971"></span>58971</td>
<td class="instruction">LD B,1</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58973"></span>58973</td>
<td class="instruction">CALL 3545</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58976"></span>58976</td>
<td class="instruction">LD BC,(23540)</td>
<td class="comment-1" rowspan="3">Increment *<a href="23540.html">PlayerBooty</a> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58980"></span>58980</td>
<td class="instruction">INC BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58981"></span>58981</td>
<td class="instruction">LD (23540),BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58985"></span>58985</td>
<td class="instruction">CALL 6683</td>
<td class="comment-1" rowspan="1">Call <a rel="noopener nofollow" href="https://skoolkid.github.io/rom/asm/1A1B.html">OUT_NUM_1</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58988"></span>58988</td>
<td class="instruction">LD C,5</td>
<td class="comment-1" rowspan="3">Set up the screen buffer location 5/1 using <a rel="noopener nofollow" href="https://skoolkid.github.io/rom/asm/0DD9.html">CL_SET</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58990"></span>58990</td>
<td class="instruction">LD B,1</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58992"></span>58992</td>
<td class="instruction">CALL 3545</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58995"></span>58995</td>
<td class="instruction">LD BC,(23538)</td>
<td class="comment-1" rowspan="3">Decrease *<a href="23538.html">PlayerTreasure</a> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58999"></span>58999</td>
<td class="instruction">DEC BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59000"></span>59000</td>
<td class="instruction">LD (23538),BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59004"></span>59004</td>
<td class="instruction">LD A,B</td>
<td class="comment-1" rowspan="3">Jump to <a href="58868.html#59033">Handler_Items_1</a> if <span class="register">B</span> is not equal to 0.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59005"></span>59005</td>
<td class="instruction">CP 0</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59007"></span>59007</td>
<td class="instruction">JR NZ,<a href="58868.html#59033">Handler_Items_1</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59009"></span>59009</td>
<td class="instruction">LD A,C</td>
<td class="comment-1" rowspan="3">Jump to <a href="58868.html#59033">Handler_Items_1</a> if <span class="register">C</span> is not equal to 50.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59010"></span>59010</td>
<td class="instruction">CP 50</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59012"></span>59012</td>
<td class="instruction">JR NZ,<a href="58868.html#59033">Handler_Items_1</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59014"></span>59014</td>
<td class="instruction">LD A,(23507)</td>
<td class="comment-1" rowspan="2">Write *<a href="23507.html">CurrentRoom</a> to *<a href="23548.html">GoldenKeyRoom</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59017"></span>59017</td>
<td class="instruction">LD (23548),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59020"></span>59020</td>
<td class="instruction">LD A,(IX+0)</td>
<td class="comment-1" rowspan="2">Write *<span class="register">IX</span>+0 to *<a href="23549.html">PositionGoldenKey</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59023"></span>59023</td>
<td class="instruction">LD (23549),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59026"></span>59026</td>
<td class="instruction">LD A,(IX+1)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=*<span class="register">IX</span>+1.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59029"></span>59029</td>
<td class="instruction">INC A</td>
<td class="comment-1" rowspan="1">Increment <span class="register">A</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59030"></span>59030</td>
<td class="instruction">LD (23550),A</td>
<td class="comment-1" rowspan="1">Write <span class="register">A</span> to *<a href="23549.html#23550">23550</a>.</td>
</tr>
<tr>
<td class="asm-label">Handler_Items_1</td>
<td class="address-2"><span id="59033"></span>59033</td>
<td class="instruction">LD A,C</td>
<td class="comment-1" rowspan="2">Compare <span class="register">C</span> with 0.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59034"></span>59034</td>
<td class="instruction">CP 0</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59036"></span>59036</td>
<td class="instruction">PUSH AF</td>
<td class="comment-1" rowspan="1">Stash <span class="register">AF</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59037"></span>59037</td>
<td class="instruction">CALL NZ,6683</td>
<td class="comment-1" rowspan="1">Call <a rel="noopener nofollow" href="https://skoolkid.github.io/rom/asm/1A1B.html">OUT_NUM_1</a> if <span class="register">C</span> was not zero on line <a href="58868.html#59033">Handler_Items_1</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59040"></span>59040</td>
<td class="instruction">LD A,32</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=ASCII "space" (32).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59042"></span>59042</td>
<td class="instruction">CALL <a href="59100.html">PrintColourCharacter</a></td>
<td class="comment-1" rowspan="1">Call <a href="59100.html">PrintColourCharacter</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59045"></span>59045</td>
<td class="instruction">POP AF</td>
<td class="comment-1" rowspan="1">Restore <span class="register">AF</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59046"></span>59046</td>
<td class="instruction">RET NZ</td>
<td class="comment-1" rowspan="1">Return if {} is not zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59047"></span>59047</td>
<td class="instruction">LD A,45</td>
<td class="comment-1" rowspan="2">Write 45 to *<a href="23551.html">TimerGoldenKey</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59049"></span>59049</td>
<td class="instruction">LD (23551),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59052"></span>59052</td>
<td class="instruction">LD BC,20</td>
<td class="comment-1" rowspan="2">Write 0020 to *<a href="23546.html">TimerGoldenKey_FrameSkip</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59055"></span>59055</td>
<td class="instruction">LD (23546),BC</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="59059"></span>
<div class="comments">
<div class="paragraph">
Restore the default ZX Spectrum font.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59059"></span>59059</td>
<td class="instruction">LD HL,15360</td>
<td class="comment-1" rowspan="2">Write <a rel="noopener nofollow" href="https://skoolkit.ca/disassemblies/rom/hex/asm/3D00.html">15360</a> (CHARSET-256) to *<a rel="noopener nofollow" href="https://skoolkit.ca/disassemblies/rom/hex/asm/5C36.html">CHARS</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59062"></span>59062</td>
<td class="instruction">LD (23606),HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="59065"></span>59065</td>
<td class="instruction">JP <a href="57513.html#57591">PrintFindTheGoldKey</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="57513.html#57591">PrintFindTheGoldKey</a>.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="58753.html">58753</a>
</td>
<td class="up">Up: <a href="../maps/all.html#58868">Map</a></td>
<td class="next">
Next: <a href="59068.html">59068</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1984 Firebird &copy; 2024 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 9.1.</div>
<div class="repository">Link to <a href="https://github.com/pobtastic/booty/">Source code</a>.</div>
<div><a href="asm/58868.html">Switch to hexadecimal</a>.</div>
</footer>
</body>
</html>